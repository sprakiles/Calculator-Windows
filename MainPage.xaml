<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="Calculator.MainPage"
             BackgroundColor="{AppThemeBinding Light={StaticResource LightPageBackgroundColor}, Dark={StaticResource DarkPageBackgroundColor}}">

    <Grid RowDefinitions="Auto, Auto, Auto, *" Padding="25" RowSpacing="15">
        
        <!-- Header -->
        <HorizontalStackLayout Grid.Row="0" Spacing="10" VerticalOptions="Center">
            <Border StrokeShape="RoundRectangle 20" StrokeThickness="0" 
                    BackgroundColor="{AppThemeBinding Light={StaticResource LightOperatorButtonBackgroundColor}, Dark={StaticResource DarkOperatorButtonBackgroundColor}}"
                    HeightRequest="32" WidthRequest="60" Padding="4">
                <Grid>
                    <Ellipse x:Name="ThemeToggleKnob" Fill="{AppThemeBinding Light={StaticResource LightPageBackgroundColor}, Dark={StaticResource DarkPageBackgroundColor}}" 
                             HeightRequest="24" WidthRequest="24" HorizontalOptions="Start" />
                </Grid>
                <Border.GestureRecognizers>
                    <TapGestureRecognizer Tapped="OnThemeSwitchClicked" />
                </Border.GestureRecognizers>
            </Border>
            <Label Text="{AppThemeBinding Light='Switch to Dark', Dark='Switch to Light'}" 
                   VerticalOptions="Center" FontSize="14" FontAttributes="Bold"
                   TextColor="{AppThemeBinding Light={StaticResource LightDisplayTextColor}, Dark={StaticResource DarkDisplayTextColor}}" />
        </HorizontalStackLayout>

        <!-- Display -->
        <VerticalStackLayout Grid.Row="1" Spacing="5" Margin="0,20,0,10" HorizontalOptions="End">
            <Label x:Name="CalculationText" Style="{StaticResource SubDisplayLabel}" Text="45 x 24" Opacity="0.6" />
            <Label x:Name="ResultText" Style="{StaticResource DisplayLabel}" Text="1080" FontSize="64" />
        </VerticalStackLayout>

        <!-- Separator -->
        <BoxView Grid.Row="2" HeightRequest="1" Color="{AppThemeBinding Light={StaticResource LightDisplayTextColor}, Dark={StaticResource DarkDisplayTextColor}}" Opacity="0.2" Margin="0,0,0,10" />

        <!-- Button Grid -->
        <Grid Grid.Row="3" RowDefinitions="*,*,*,*,*" ColumnDefinitions="*,*,*,*" ColumnSpacing="12" RowSpacing="12">
            
            <!-- Row 0 -->
            <Button Grid.Row="0" Grid.Column="0" Text="C" Clicked="OnClearClicked" Style="{StaticResource OtherButton}" />
            <Button Grid.Row="0" Grid.Column="1" Text="( )" Clicked="OnBracketClicked" Style="{StaticResource OtherButton}" />
            <Button Grid.Row="0" Grid.Column="2" Text="%" Clicked="OnPercentageClicked" Style="{StaticResource OtherButton}" />
            <Button Grid.Row="0" Grid.Column="3" Text="/" Clicked="OnOperatorClicked" Style="{StaticResource OperatorButton}" />
            
            <!-- Row 1 -->
            <Button Grid.Row="1" Grid.Column="0" Text="7" Clicked="OnNumberClicked" Style="{StaticResource NumberButton}" />
            <Button Grid.Row="1" Grid.Column="1" Text="8" Clicked="OnNumberClicked" Style="{StaticResource NumberButton}" />
            <Button Grid.Row="1" Grid.Column="2" Text="9" Clicked="OnNumberClicked" Style="{StaticResource NumberButton}" />
            <Button Grid.Row="1" Grid.Column="3" Text="x" Clicked="OnOperatorClicked" Style="{StaticResource OperatorButton}" TextTransform="None" />

            <!-- Row 2 -->
            <Button Grid.Row="2" Grid.Column="0" Text="4" Clicked="OnNumberClicked" Style="{StaticResource NumberButton}" />
            <Button Grid.Row="2" Grid.Column="1" Text="5" Clicked="OnNumberClicked" Style="{StaticResource NumberButton}" />
            <Button Grid.Row="2" Grid.Column="2" Text="6" Clicked="OnNumberClicked" Style="{StaticResource NumberButton}" />
            <Button Grid.Row="2" Grid.Column="3" Text="-" Clicked="OnOperatorClicked" Style="{StaticResource OperatorButton}" />
            
            <!-- Row 3 -->
            <Button Grid.Row="3" Grid.Column="0" Text="1" Clicked="OnNumberClicked" Style="{StaticResource NumberButton}" />
            <Button Grid.Row="3" Grid.Column="1" Text="2" Clicked="OnNumberClicked" Style="{StaticResource NumberButton}" />
            <Button Grid.Row="3" Grid.Column="2" Text="3" Clicked="OnNumberClicked" Style="{StaticResource NumberButton}" />
            <Button Grid.Row="3" Grid.Column="3" Text="+" Clicked="OnOperatorClicked" Style="{StaticResource OperatorButton}" />
            
            <!-- Row 4 -->
            <Button Grid.Row="4" Grid.Column="0" Text="+/-" Clicked="OnSignClicked" Style="{StaticResource NumberButton}" />
            <Button Grid.Row="4" Grid.Column="1" Text="0" Clicked="OnNumberClicked" Style="{StaticResource NumberButton}" />
            <Button Grid.Row="4" Grid.Column="2" Text="." Clicked="OnDecimalClicked" Style="{StaticResource NumberButton}" />
            <Button Grid.Row="4" Grid.Column="3" Text="=" Clicked="OnEqualsClicked" Style="{StaticResource EqualsButton}" />
        </Grid>
    </Grid>

</ContentPage>